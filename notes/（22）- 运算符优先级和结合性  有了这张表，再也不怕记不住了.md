# （22）- 运算符优先级和结合性 | 有了这张表，再也不怕记不住了

[toc]

## 一、运算符简介

- 运算符用于执行程序代码运算，会针对一个、两个或多个操作数来进行运算。例如：1 + 2，其操作数是 1 和 2，而运算符则是 “+”（加号）。
- C语言把除了 **控制语句** 和 **输入输出** 以外的几乎所有的基本操作都作为运算符处理，可见一斑。

## 二、运算符分类

- 将按功能分类，可以分为：后缀运算符、单目运算符、算术运算符、关系运算符、位运算符、逻辑运算符、条件运算符、赋值运算符、逗号运算符。

![20210710133157266](D:/GitRep/CP/notes/%EF%BC%8822%EF%BC%89-%20%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7%E5%92%8C%E7%BB%93%E5%90%88%E6%80%A7%20%20%E6%9C%89%E4%BA%86%E8%BF%99%E5%BC%A0%E8%A1%A8%EF%BC%8C%E5%86%8D%E4%B9%9F%E4%B8%8D%E6%80%95%E8%AE%B0%E4%B8%8D%E4%BD%8F%E4%BA%86.assets/20210710133157266.png)

- 在之前的章节也有介绍了很多运算符，这里简单做个总结：

| 运算符类型     | 运算符举例       | 参考文章                                                     |
| -------------- | ---------------- | ------------------------------------------------------------ |
| 后缀运算符     | `[]`下标运算     | 会在数组章节讲解，待更新                                     |
| 单目运算符     | `(type)`强制转换 | [光天化日学C语言（12）- 类型转换](D:/GitRep/CP/notes/（12）- 类型转换  今天你打卡了吗？.md) |
| 算术运算符     | `+`加号          | [光天化日学C语言（09）- 算术运算符](D:/GitRep/CP/notes/（09）- 算术运算符  小学就会了？温故而知新，可以为师矣！.md) |
| 移位运算符     | `<<`左移         | [光天化日学C语言（18）- 位运算 ＜＜ 的应用](D:/GitRep/CP/notes/（18）- 位运算 ＜＜ 的应用  左移的一些高端用法.md) |
| 关系运算符     | `<`小于          | [光天化日学C语言（10）- 关系运算符](D:/GitRep/CP/notes/（10）- 关系运算符  3 ＞ 2 ＞ 1 真的成立吗？.md) |
| 双目位运算符   | `&`位与          | [光天化日学C语言（14）- 位运算 & 的应用](D:/GitRep/CP/notes/（14）- 位运算 & 的应用  C语言课上学不到的哦.md) |
| 双目逻辑运算符 | `&&`             | [光天化日学C语言（11）- 逻辑运算符](D:/GitRep/CP/notes/（11）- 逻辑运算符  我是一个有逻辑的人.md) |
| 条件运算符     | `? :`            | 会在`if`语句章节讲解，待更新                                 |
| 赋值运算符     | `<<=`左移后赋值  | [光天化日学C语言（20）- 赋值运算符与赋值表达式](D:/GitRep/CP/notes/（20）- 赋值运算符  让代码变得更加简洁.md) |
| 逗号运算符     | `,`逗号          | [光天化日学C语言（21）- 逗号运算符](D:/GitRep/CP/notes/（21）- 逗号运算符  压缩代码的神器.md) |

## 三、运算符的优先级和结合性

### 1、运算符优先级表（建议收藏）

| 优先级 | 运算符   | 名称           | 形式                       | 举例        |
| ------ | -------- | -------------- | -------------------------- | ----------- |
| 1      | `[]`     | 数组下标       | 数组名[常量表达式]         | `a[2]`      |
| 1      | `()`     | 圆括号         | (表达式) 或 函数名(形参表) | `(a+1)`     |
| 1      | `.`      | 对象的成员选择 | 对象.成员名                | `a.b`       |
| 1      | `->`     | 指针的成员选择 | 指针.成员名                | `a->b`      |
| 2      | `+`      | 正号           | +表达式                    | `+5`        |
| 2      | `-`      | 负号           | -表达式                    | `-5`        |
| 2      | `(type)` | 强制类型转换   | (数据类型)表达式           | `(int)a`    |
| 2      | `++`     | 自增运算符     | ++变量名 / 变量名++        | `++i`       |
| 2      | `--`     | 自减运算符     | –变量名 / 变量名–          | `--i`       |
| 2      | `!`      | 逻辑非         | !表达式                    | `!a[0]`     |
| 2      | `~`      | 按位取反       | ~表达式                    | `~a`        |
| 2      | `&`      | 取地址         | &变量名                    | `&a`        |
| 2      | `*`      | 解引用         | *指针变量名                | `*a`        |
| 2      | `sizeof` | 取长度         | sizeof(表达式)             | `sizeof(a)` |
| 3      | `*`      | 乘             | 表达式*表达式              | `3 * 5`     |
| 3      | `/`      | 除             | 表达式/表达式              | `3 / 5`     |
| 3      | `%`      | 模             | 整型表达式%整型非零表达式  | `3 % 5`     |
| 4      | `+`      | 加             | 表达式+表达式              | `a + b`     |
| 4      | `-`      | 减             | 表达式-表达式              | `a - b`     |
| 5      | `<<`     | 左移           | 变量<<表达式               | `1 << 5`    |
| 5      | `>>`     | 右移           | 变量>>表达式               | `x >> 1`    |
| 6      | `<`      | 小于           | 表达式<表达式              | `1 < 2`     |
| 6      | `<=`     | 小于等于       | 表达式<=表达式             | `1 <= 2`    |
| 6      | `>`      | 大于           | 表达式>表达式              | `1 > 2`     |
| 6      | `>=`     | 大于等于       | 表达式>=表达式             | `1 >= 2`    |
| 7      | `==`     | 等于           | 表达式==表达式             | `1 == 2`    |
| 7      | `!=`     | 不等于         | 表达式!=表达式             | `1 != 2`    |
| 8      | `&`      | 等于           | 表达式&表达式              | `1 & 2`     |
| 9      | `^`      | 等于           | 表达式^表达式              | `1 ^ 2`     |
| 10     | `|`      | 等于           | 表达式\|表达式             | `1 | 2`     |
| 11     | `&&`     | 逻辑与         | 表达式&&表达式             | `1 && 2`    |
| 12     | `||`     | 逻辑或         | 表达式\|\|表达式           | `1 || 2`    |
| 13     | `?:`     | 条件运算符     | 表达式1? 表达式2: 表达式3  | `a>b?a:b`   |
| 14     | `=`      | 赋值           | 变量=表达式                | `a = b`     |
| 14     | `+=`     | 加后赋值       | 变量+=表达式               | `a += b`    |
| 14     | `-=`     | 减后赋值       | 变量-=表达式               | `a -= b`    |
| 14     | `*=`     | 乘后赋值       | 变量*=表达式               | `a *= b`    |
| 14     | `/=`     | 除后赋值       | 变量/=表达式               | `a /= b`    |
| 14     | `%=`     | 模后赋值       | 变量%=表达式               | `a %= b`    |
| 14     | `>>=`    | 右移后赋值     | 变量>>=表达式              | `a >>= b`   |
| 14     | `<<=`    | 左移后赋值     | 变量<<=表达式              | `a <<= b`   |
| 14     | `&=`     | 位与后赋值     | 变量&=表达式               | `a &= b`    |
| 14     | `^=`     | 异或后赋值     | 变量^=表达式               | `a ^= b`    |
| 14     | `|=`     | 位或后赋值     | 变量`|=`表达式             |             |
| 15     | `,`      | 位或后赋值     | 表达式1,表达式2,…          | `a |= b`    |

## 2、结合性

> 结合方向只有 **3** 个是 **从右往左**，其余都是 **从左往右**（比较符合人的直观感受）。
>   （1）一个是单目运算符；
>   （2）一个是双目运算符中的 赋值运算符；
>   （3）一个条件运算符，也就是C语言中唯一的三目运算符。

## 3、优先级

> 后缀运算符和单目运算符优先级一般最高，逗号运算符的优先级最低。快速记忆如下：
>
> 单目逻辑运算符 > 算术运算符 > 关系运算符 > 双目逻辑运算符 > 赋值运算符

## 四、运算符的优先级和结合性举例

---

### 例题1

```c
#include <stdio.h>
int main() {
    int a = 1, b = 2, c = 3;
    a <<= b <<= c;
    printf("%d\n", a ); 
    return 0;
}
```

> 【运行结果】65536
> 【结果答疑】`a <<= b <<= c`的计算方式等价于`a = (a << (b << c))`，结果为`1 << 16`。

---

### 例题2

```c
#include <stdio.h>
int main() {
    int a = 1, b = 2;
    printf("%d\n", a > b ? a + b : a - b ); 
    return 0;
}
```

> 【运行结果】-1
> 【结果答疑】条件运算符的优先级较低，低于关系运算符和算术运算符，所以`a > b ? a + b : a - b`等价于`1 > 2 ? 3 : -1`。

---

### 例题3

```c
#include <stdio.h>
int main() {
    int a = 1;
    --a && --a;
    printf("%d\n", a); 
    return 0;
}
```

> 【运行结果】0
> 【结果答疑】这个例子是展示逻辑与运算符`&&`从左往右计算过程中，一旦遇到 0 就不再进行运算了，所以`--a`实际上只执行了一次。

---

### 例题4

```c
#include <stdio.h>
int main() { 
    int x = 0b010000; 
    printf("%d\n", x | x - 1 ); 
    return 0;
}
```

> 【运行结果】31
> 【结果答疑】这个例子是是将低位连续的零变成一，但是一般这样的写法会报警告，因为编译程序并不知道你的诉求，到底是想先计算 | 还是先计算 `-`，由于这个问题我们实际要计算的是`x | (x - 1)`，并且减法运算符`-`优先级高于位或运算符 | ，所以括号是可以省略的。

### 例题5

```c
#include <stdio.h>
int main() {
    int a = 0b1010;
    int b = 0b0101;
    int c = 0b1001;
    printf("%d\n", a | b ^ c );
    return 0;
}
```

> 【运行结果】14
> 【结果答疑】这个例子表明了异或运算符`^`高于位或运算符 | 。

### 例题6

```c
#include <stdio.h>
int main() {
    int a = 0b1010;
    int b = 0b0110;
    printf("%d\n", a & b == 2);
    return 0;
}
```

> 【运行结果】0
> 【结果答疑】延续【例题59】继续看，之前`a & b`输出的是`2`，那为什么加上等于`==`判定后，输出结果反而变成`0`了呢？原因是因为`==`的优先级高于位与`&`，所以相当于进行了`a & 0`的操作，结果自然就是0了。
