# （16）- 位运算 ^ 的应用 | 最神奇的异或运算

[toc]

## 一、异或运算符

- 异或运算符是一个二元的位运算符，也就是有两个操作数，表示为`x ^ y`。
- 异或运算会对操作数的每一位按照如下表格进行运算，对于每一位只有 0 或 1 两种情况，所以组合出来总共2^2^=4种情况。

| 左操作数 | 右操作数 | 结果 |
| -------- | -------- | ---- |
| 0        | 0        | 0    |
| 0        | 1        | 1    |
| 1        | 0        | 1    |
| 1        | 1        | 0    |

- 通过这个表，我们得出一些结论。
- 1. 两个相同的十进制异或的结果一定为零。
  2. 任何一个数和0的异或结果一定时它本身。
  3. 异或运算满足结合和交换率。

> 异或运算的特点是：只要相同就为0，不同就为1。

```c
#include <stdio.h>
int main() {
    int a = 0b1010;           // (1)
    int b = 0b0110;           // (2)
    printf("%d\n", (a ^ b) ); // (3)
    return 0;
}
```

- 1. 在C语言中，以`0b`作为前缀，表示这是一个二进制数。那么`a`的实际值就是(1010)~2~。
  1. 同样的，`b`的实际值就是(0110)~2~。
  1. 那么这里`a ^ b`就是对(1010)~2~和(0110)~2~的每一位做表格中的`^`运算。
- 所以最后输出结果为：

```c
12
```

- 因为输出的是十进制数，它的二进制表示为：(1100)~2~。

## 二、异或运算符的应用

1. ### 标记位取反

> 【例题1】给定一个数，将它的低位数起的第 4 位取反，0 变 1，1 变 0。

- 这个问题，我们很容易联想到异或。
- 我们分析一下题目意思，如果第 4 位为 1，则让它异或上 `0b1000`就能变成 0；如果第 4 位 为 0，则让它异或上 `0b1000`就能变成 1，也就是无论如何都是异或上 `0b1000`，代码如下：

```c
#include <stdio.h>
int main() {
    int x;
    scanf("%d", &x);
    printf("%d\n", x ^ 0b1000); 
    return 0;
}
```

2. ### 变量交换

> 【例题2】给定两个数a和b，用异或运算交换它们的值。

- 这个是比较老的面试题了，直接给出代码：

```c
#include <stdio.h>
int main() {
    int a, b;
	while (scanf("%d %d", &a, &b) != EOF) {
	    a = a ^ b;   // (1)
	    b = a ^ b;   // (2)
	    a = a ^ b;   // (3)
	    printf("%d %d\n", a, b);
	}
	return 0;
}
```

- 我们直接来看（1）和（2）这两句话，相当于`b`等于`a^b^b`，根据异或的几个性质，我们知道，这时候的`b`的值已经变成原先`a`的值了。
- 而再来看第（3）相当于`a`等于`a ^ b ^ a`，还是根据异或的几个性质，这时候，`a`的值已经变成了原先`b`的值。

- 从而实现了变量`a`和`b`的交换。

3. ### 出现奇数次的数

> 【例题3】输入n个数，其中只有一个数出现了奇数次，其它所有数都出现了偶数次。求这个出现了奇数次的数。

- 根据异或的性质，两个一样的数异或结果为零。也就是所有出现偶数次的数异或都为零，那么把这n个数都异或一下，得到的数就一定是一个出现奇数次的数了。

```c
#include <stdio.h>
int main() {
    int n, x, i, ans;
    scanf("%d", &n);
    ans = 0;
    for(i = 0; i < n; ++i) {
        scanf("%d", &x);
        ans = (ans ^ x);
    } 
    printf("%d\n", ans);
    return 0;
}
```

4. ### 丢失的数

> 【例题4】给定一个n-1个数，分别代表 1 到n的其中n − 1个，求丢失的那个数。

5. ### 简单加密
   - 基于 **两个数异或为零**，**任何数和零异或为其本身** 这两个特点，异或还可以用来做简单的加密。
   - 将明文异或上一个固定的数变成密文以后，可以通过继续异或上这个数，再将密文转变成明文。