# （30）- for 语句 | 子子孙孙无穷尽也

[toc]

## 一、for 语句简介

- 对于循环结构，除了 while 语句以外，还有 for 语句。

### 1、语法规则

- for 语句的一般形式为：

```c
for(循环初始化表达式; 循环条件表达式; 循环执行表达式){
    循环体
}
```

> 它的运行过程为：
>
>   1）首先，执行 **循环初始化表达式**；
>
>   2）然后，执行 **循环条件表达式**，如果它的值为真，则执行**循环体**，否则结束循环；
>
>   3）接着，执行完循环体后再执行 **循环执行表达式**；
>
>   4）重复执行步骤 2）和 3），直到 **循环条件表达式** 的值为假，则结束循环。

- 上面的步骤中，2）和 3）是一次循环，会重复执行，for 语句的主要作用就是不断执行步骤 2）和 3）。执行过程如下图所示：

![febd1657d19d40f995b7bc1f2671985f](D:/GitRep/CP/notes/%EF%BC%8830%EF%BC%89-%20for%20%E8%AF%AD%E5%8F%A5%20%20%E5%AD%90%E5%AD%90%E5%AD%99%E5%AD%99%E6%97%A0%E7%A9%B7%E5%B0%BD%E4%B9%9F.assets/febd1657d19d40f995b7bc1f2671985f.png)

- 细心的读者可能会发现，**循环体** 和 **循环执行表达式** 其实是可以合并的，是的，的确是这样。在下面的例子中我会讲到。

### 2、简单应用

- 接下来，我们就来实现一个最简单的循环语句，求 1+2+3+...+n 的值。

```c
#include <stdio.h>

int main() {
    int n, i;
    int sum;
    while(scanf("%d", &n) != EOF) { // (1)
        sum = 0;                    // (2)
        for(i = 1; i <= n; ++i) {   // (3)
            sum += i;               // (4)
        }
        printf("%d\n", sum);        // (5)
    }
    return 0;
} 
```

- (1) 通过输入函数，输入一个数 n ，代表求和的上限；

- (2) 初始化求和的值为 0；

- (3) for 语句三部分：循环初始化表达式：`i = 1`；循环条件表达式：`i <= n`；循环执行表达式：`++i`；

- (4) 循环体：`sum += i;`，表示将 1、2、3、4、… 累加到 `sum`上；

- (5) 输出求和`sum`的值；

- 以上这段代码，实现了一个数学上的 等差数列 求和。也可以用公式来表示，如下：

- $$
  sum=\frac{(1+n)n}{2}
  $$
  
  
  
- 而利用 for 循环，让我们抛开了数学思维，用程序的角度来实现数学问题。

> 【例题1】给定一个整数 n(1≤n≤12)，输出 1×2×3×4×...×n 的值。

```c
#include <stdio.h>
int main()
{
	int i;
	int sum = 1;

	for (i = 1; i <= 12; ++i) {
		sum *= i;
	}

	printf("%d\n", sum);
	return 0;
}
```

## 二、for 语句中的表达

- for 循环中的那个表达式都可以省略，但它们之间的 **分号** 必须保留。

### 1、初始化表达式

#### 1）初始化表达式外置

- 我们可以把 **初始化表达式** 提到 for 循环外面，如下：

```c
    int i = 1, sum = 0;         // (2)
    for(; i <= n; ++i) {        // (3)
        sum += i;               // (4)
    }
```

- 其中注释中的编号对应上文代码中的编号。

#### 2）初始化表达式内置

- 我们也可以把需要的初始化信息，都在 **初始化表达式** 内进行赋值，并且用逗号进行分隔，如下：

```c
    int i, sum;                           // (2)
    for(i = 1, sum = 0; i <= n; ++i) {    // (3)
        sum += i;                         // (4)
    }
```

- 具体选择哪种方式，是 **代码规范** 的问题，不在本文进行讨论，都是可以的。

### 2、条件表达式

- 如果省略 **条件表达式**，那就代表这个循环是一个 **死循环**，如下：

```c
    int i, sum = 0;           // (2)
    for(i = 1;; ++i) {        // (3)
        sum += i;             // (4)
    }
```

- 这段代码表示这个循环没有 **结束条件**，那自然就不会结束了，编码过程中应该尽量避免（当然，某些情况下还是需要的，例如游戏开发中的主循环），或者，函数内部有能够跳出函数的方法，比如 break 关键字。

### 3、执行表达式

- **执行表达式** 的作用是 让循环条件 逐渐 不成立，从而跳出循环。

- 当然，它也是可以省略的，因为 **循环体** 本身也是一个 语句块，也可以达到类似功能，如下代码所示：

```c
    int i, sum = 0;           // (2)
    for(i = 1; i <= n;) {     // (3)
        sum += i;             // (4)
        ++i;
    }
```

- 这段代码同样达到了求和的功能，因为 **执行表达式** 被放入了 **循环体**，这也正是上文所说的 **循环体** 和 **循环执行表达式** 合并的问题。

## 三、for 语句 类比 while 语句

- 最后，我们将 for 循环 和 while 循环 进行一个类比。
- 还是以求和为例，如下代码所示：

```c
#include <stdio.h>

int main() {
    int n, i;
    int sum;
    while(scanf("%d", &n) != EOF) {
        sum = 0;                 
        for(i = 1 /*(1)*/; i <= n/*(2)*/; ++i /*(3)*/) {
            sum += i;               // (4)
        }
        printf("%d\n", sum);
    }
    return 0;
} 
```

- 我们把它用 while 语句来实现，如下：

```c
#include <stdio.h>
int main(){
    int n, i, sum;
    while(scanf("%d", &n) != EOF) {
        sum = 0;
        i = 1;       /*(1)*/ 
        while(i <= n /*(2)*/ ) {
            sum += i;/*(4)*/
            i ++;    /*(3)*/
        }
        printf("%d\n",sum);        
    }
    return 0;
}
```

- (1) 循环初始化；
- (2) 循环条件；
- (3) 循环执行；
- (4) 循环体；
- 写成 while 语句以后，更加确定了一件事情，就是 (3) 和 (4) 其实是一回事。