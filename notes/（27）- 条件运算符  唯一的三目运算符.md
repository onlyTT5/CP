# （27）- 条件运算符 | 唯一的三目运算符

[toc]

## 一、条件运算符

- 在学习 [☀️光天化日学C语言☀️（26）- if else 语句](D:\GitRep\CP\notes\（26）- if else 语句  if (years ＞ 18) enter = 1；.md) 时，我们了解到了条件判断，分支类型的程序结构，例如：

```c
if (a > b) {
    x = a;
}else {
    x = b;
}
```

- 在 C语言中，提供了一种更加简单的语法，被称为 **条件运算符**，语法如下：

```c
    表达式1 ? 表达式2 : 表达式3
```

- 以上由 **条件运算符** 组成的式子被称为 **条件表达式**。
- 条件运算符是 C语言 中唯一的一个三目运算符，其求值规则为：如果 **表达式1** 的值为 **真**，则以 **表达式2** 的值作为整个 **条件表达式** 的值，否则以 **表达式3** 的值作为整个 **条件表达式** 的值。
- 条件表达式通常用于赋值语句之中。
- 所以上面的`if else`语句，完全可以用 **条件运算符** 来实现，如下：

```c
    x = (a > b) ? a : b;
```

- 注意：这里的`?`和`:`是一个整体，是不能分隔的，不可单独使用。

## 二、条件运算符的嵌套

- 由于条件表达式中的每个表达式可以又是一个条件表达式，所以是会产生嵌套的。
- 例如，我们用`((a > c) ? a : c)`来对 **表达式2** 进行替换，得到：

```c
    x = (a > b) ? ((a > c) ? a : c) : b;
```

- 那么让我们来看看以下这段代码的输出吧：

```c
#include <stdio.h>
int main() {
    int a = 3, b = 4, c = 5;
    int x =  (a > b) ? ((a > c) ? a : c) : ((b < c) ? b : c);
    printf("%d\n", x);
    return 0;
}
```

- 首先计算的是 `(a > b)`是否为真，`(3 > 5)`结果自然不为真，所以我们走的是后面的分支，即`((b < c) ? b : c)`，得到的结果为求`b`和`c`的最小值，所以为 4，而这也就是整个条件表达式的值。

- 所以这段代码的运行结果为：

```c
4
```

- 当然，这样的代码可读性就很差，实际编码中，我们也不推荐这样的写法。
- 后面我们学了函数以后，实现这段逻辑时，代码就能清晰很多。

## 三、条件运算符的值类型

- 条件运算符对应的值类型如何确定呢？

```c
#include <stdio.h>

int main() {
    double a = 0 ? 1 : 1.5;
    printf("%lf\n", a);
    return 0;
}
```

- 这段代码的运行结果为：

```c
1.500000
```

- 这样，起码我们可以确定的是 `0 ? 1 : 1.5`的类型是`double`，因为如果是整数的话，最后不可能返回一个浮点数。事实上，它的类型是由 **表达式2** 和 **表达式3** 决定的，类型转换遵循以下规则：

![20210629080729825](D:/GitRep/CP/notes/%EF%BC%8827%EF%BC%89-%20%E6%9D%A1%E4%BB%B6%E8%BF%90%E7%AE%97%E7%AC%A6%20%20%E5%94%AF%E4%B8%80%E7%9A%84%E4%B8%89%E7%9B%AE%E8%BF%90%E7%AE%97%E7%AC%A6.assets/20210629080729825.png)

- 也就是说 **表达式2** 是`int`，**表达式3** 是`unsigned`，则条件表达式的值返回的就是`unsigned`类型的。

## 三、条件运算符的优先级和结合性

### 1、优先级

> 条件运算符的优先级比较低，仅高于 赋值运算符 和 逗号运算符，所以使用的时候不用担心优先级问题。

```c
#include <stdio.h>

int main() {
    int a = 3, b = 4;
    int x =  a > b ? a : b;    // (1)
    int y = (a > b) ? a : b;   // (2)
    printf("%d %d\n", x, y);
    return 0;
}
```

- 所以上文中的 (1) 和 (2) 是等价的，因为关系运算符`>`的优先级高于`?:`，所以先计算`a > b`这个表达式的值，最后得到的结果为`4`。

2、结合性

> 条件运算符的结合性是右结合的。

```c
#include <stdio.h>
int main() {
    int a = 3, b = 4, c = 5;
    int x =  a < b ? a > c ? a : c : b;
    printf("%d\n", x);
    return 0;
}
```

- 第一眼看到这个的时候，一脸懵逼，比如`< b ? a >`是个什么鬼？？？
- 当然，这不重要，我们只需要知道结合性是又结合的，就能把这个表达式转换成如下形式：
- `a < b ? (a > c ? a : c) : b`
- 这样就转化成了条件表达式的嵌套，首先`a < b`条件满足，所以我们只需要知道`(a > c ? a : c)`的值，就是最终条件表达式的值了，即`3 > 5 ? 3 : 5`的值，即`5`。

## 四、条件运算符的特点总结

> 条件运算符 和 条件表达式 的几个特点总结如下：
>
>   1）条件运算符是唯一的三目运算符；
>
>   2）条件运算符是右结合的；
>
>     3）条件运算符的优先级非常低，仅高于赋值运算符 和 逗号运算符；